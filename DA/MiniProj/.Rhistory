pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=nox, y=ptratio))  + geom_point()
multiplot(plt_nox, plt_pupil)
#lm( , data=boston.c)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=nox, y=ptratio))  + geom_point()
multiplot(plt_nox, plt_pupil, ncol = 2)
#lm( , data=boston.c)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=nox, y=ptratio))  + geom_point()
multiplot(plt_nox, plt_pupil, cols=2)
#lm( , data=boston.c)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, cols=2)
#lm( , data=boston.c)
library(MASS)
library(ggplot2)
# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.
#
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col, just = "centre"))
}
}
}
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, cols=2)
#lm( , data=boston.c)
library(MASS)
library(ggplot2)
# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.
#
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, cols=2)
#lm( , data=boston.c)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_black <- ggplot(data=Boston, aes(x=black, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_black, cols=3)
#lm( , data=boston.c)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_black <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_black, cols=3)
#lm( , data=boston.c)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=3)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
lm(crim ~ nox + ptratio + lstat + age , data=Boston)
first_model <- geom_smooth(method = "lm", se=FALSE, color="black", formula = crim ~ nox + lstat + ptratio + age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point() + first_model
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point() + first_model
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point() + first_model
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- geom_smooth(method = "lm", se=FALSE, color="black", formula = crim ~ nox + lstat + ptratio + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point() + first_model
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point() + first_model
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point() + first_model
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- ggplot(data=Boton) + geom_smooth(method = "lm", se=FALSE, color="black", formula = crim ~ nox + lstat + ptratio + age, data=Boston)
first_model <- ggplot(data=Boston) + geom_smooth(method = "lm", se=FALSE, color="black", formula = crim ~ nox + lstat + ptratio + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
first_model <- geom_smooth(method = "lm", se=FALSE, color="black", formula = crim ~ nox + lstat + ptratio + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + geom_smooth(method = "lm", se=FALSE, color="black", formula = crim ~ nox + lstat + ptratio + age, data=Boston)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point() + first_model
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point() + first_model
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point() + first_model
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ nox + lstat + ptratio + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point() + first_model
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point() + first_model
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point() + first_model
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point() + first_model
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point() + first_model
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point() + first_model
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
first_model <- geom_smooth(method = "lm", se=FALSE, color="red", formula = y ~ x)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point() + first_model
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point() + first_model
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point() + first_model
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
first_model <- ggplotRegression(first_model)
ggplotRegression <- function (fit) {
require(ggplot2)
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red")
}
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
first_model <- ggplotRegression(first_model)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
ggplotRegression(first_model)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
ggplotRegression(first_model)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
ggplotRegression(first_model)
print(plt_nox)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
#multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + ggplotRegression(first_model)
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
plt_nox <- geom_point() + ggplotRegression(first_model)
print(plt_nox)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
#multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + lstat + ptratio + age, data=Boston)
first_model <- geom_smooth(method = "lm", se=FALSE, color="red", formula = y ~ x)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox, data=Boston)
first_model <- geom_smooth(method = "lm", se=FALSE, color="red", formula = y ~ x)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox, data=Boston)
first_model <- geom_smooth(method = "lm", se=FALSE, color="red", formula = y ~ x)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox, data=Boston)
first_model <- ggplotRegression(first_model)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
first_model <- lm(crim ~ nox, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
first_model <- lm(crim ~ nox + ptratio, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
first_model <- lm(crim ~ nox + lstat, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
first_model <- lm(crim ~ nox + age, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
first_model <- lm(crim ~ nox + lstat, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
first_model <- lm(crim ~ nox + age, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
#plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
#plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
#plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
#plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
#multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
first_model <- lm(crim ~ nox, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
#plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
#plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
#plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
#plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
#multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
first_model <- lm(crim ~ lstat, data=Boston)
first_model <- ggplotRegression(first_model)
print(first_model)
#plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + first_model
#plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
#plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
#plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
#multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + geom_smooth(method="lm", formula = x ~ y + ptratio + lstat)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + geom_smooth(method="lm", formula = x ~ y + Boston.ptratio + lstat)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crime)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + geom_line(color='red',data = predicted_nox, aes(x=mpg_pred, y=crim)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + geom_line(color='red',data = predicted_nox, aes(x=nox, y=crim)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_boston <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point() + geom_line(color='red', data = predicted_boston, aes(x=mpg_pred, y=crim)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_boston <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_line(color='red', data = predicted_boston, aes(x=mpg_pred, y=crim)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_boston <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_boston, aes(x=mpg_pred, y=crim)
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_boston <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_boston, aes(x=mpg_pred, y=crim))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_boston <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$crim)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_boston, aes(x=mpg_pred, y=hp))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_boston <- data.frame(mpg_pred = predict(first_model, Boston), hp=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_boston, aes(x=mpg_pred, y=hp))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_boston <- data.frame(mpg_pred = predict(first_model), hp=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_boston, aes(x=mpg_pred, y=hp))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_boston_nox, aes(x=crime_nox, y=nox))
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(x=crime_nox, y=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, crime), nox=Boston$nox)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston$nox), nox=Boston$nox)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(x=crime_nox, y=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox_pred=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(x=crime_nox, y=nox_pred))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox_pred=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(x=crime_nox, y=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(x=crime_nox, y=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point() + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point() + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()+ geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color="blue")+ geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
snd_model <- lm(crim ~ nox + nox^2 + ptratio + ptratio^2 + lstat + lstat^2 + age + age^2, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(snd_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color="blue")+ geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
snd_model <- lm(crim ~ nox + nox*nox + ptratio + ptratio*ptratio + lstat + lstat*lstat + age + age*age, data=Boston)
predicted_nox <- data.frame(crime_nox = predict(snd_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color="blue")+ geom_line(color="red", data = predicted_nox, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox + ptratio + lstat + age, data=Boston)
predicted <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color="blue")+ geom_line(color="red", data = predicted, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
snd_model <- lm(crim ~ nox + nox*nox + ptratio + ptratio*ptratio + lstat + lstat*lstat + age + age*age, data=Boston)
predicted <- data.frame(crime_nox = predict(snd_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color="blue")+ geom_line(color="red", data = predicted, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
snd_model <- lm(crim ~ nox + I(nox^2) + ptratio + I(ptratio^I) + lstat + I(lstat^I) + age + I(age^2), data=Boston)
snd_model <- lm(crim ~ nox + I(nox^2) + ptratio + I(ptratio^2) + lstat + I(lstat^2) + age + I(age^2), data=Boston)
predicted <- data.frame(crime_nox = predict(snd_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color="blue")+ geom_line(color="red", data = predicted, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
first_model <- lm(crim ~ nox, data=Boston)
predicted <- data.frame(crime_nox = predict(first_model, Boston), nox=Boston$nox, ptratio=Boston$ptratio, lstat=Boston$lstat, age = Boston$age)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim)) + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=nox))
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=ptratio))
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color="blue") + geom_line(color="red", data = predicted, aes(y=crime_nox, x=lstat))
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color="blue")+ geom_line(color="red", data = predicted, aes(y=crime_nox, x=age))
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
snd_model <- lm(crim ~ nox + I(nox^2) + ptratio + I(ptratio^2) + lstat + I(lstat^2) + age + I(age^2), data=Boston)
summary(snd_model)
library(MASS)
library(ggplot2)
# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.
#
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point()
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point()
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point()
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point()
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
plt_nox <- ggplot(data=Boston, aes(x=nox, y=crim))  + geom_point(color='blue')
plt_pupil <- ggplot(data=Boston, aes(x=ptratio, y=crim))  + geom_point(color='blue')
plt_lstat <- ggplot(data=Boston, aes(x=lstat, y=crim))  + geom_point(color='blue')
plt_age <- ggplot(data=Boston, aes(x=age, y=crim))  + geom_point(color='blue')
multiplot(plt_nox, plt_pupil, plt_lstat, plt_age, cols=2)
